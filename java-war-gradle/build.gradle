apply plugin: 'java'
apply plugin: 'maven'
apply plugin: 'war'

group = '{{reversed_domain}}'
version = '1.0'
description = '{{project_name}}'
sourceCompatibility = 1.8
targetCompatibility = 1.8

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

repositories {
    maven { url 'http://repo.maven.apache.org/maven2' }
}

dependencies {
    compile group: 'javax.servlet', name: 'servlet-api', version: '2.5'
    compile group: 'javax.servlet.jsp', name: 'jsp-api', version: '2.2'
    compile group: 'org.apache.tomcat', name: 'jasper', version: '6.0.33'
}

sourceSets {
    main {
        java {
            srcDirs 'src'
            srcDirs "$buildDir/jspc"
        }
    }
}

configurations {
    jasper
}

repositories {
    mavenCentral()
}

dependencies {
    jasper 'org.apache.tomcat:jasper:6.0.33',
        'javax.servlet:jstl:1.1.2',
        'taglibs:standard:1.1.2'
}

compileJava.doFirst {
    ant.taskdef classname: 'org.apache.jasper.JspC', name: 'jasper', classpath: configurations.jasper.asPath
    ant.jasper validateXml: false, uriRoot: 'src/main/webapp', outputDir: "$buildDir/jspc"
}

war {
    exclude '**/*.jsp'
}
